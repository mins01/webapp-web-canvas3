<!doctype html>
<html lang="ko" >
<head>
    <title>web canvas 3</title>
    <meta charset="utf-8">
    <meta http-equiv="Content-Script-Type" content="text/javascript">
    <meta http-equiv="Content-Style-Type" content="text/css">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="shortcut icon" href="http://www.mins01.com/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <meta name="viewport" content="width=600px" /> -->

    <script src="/js/ForGoogle.js"></script>
    <!-- google analytics -->
    <script>if(window.ForGoogle){ ForGoogle.analytics() }else{ console.log("failure : ForGoogle.analytics()");}</script>


    <!-- 부트스트랩 아이콘 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- jquery 관련 -->
    <!-- <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js" integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin="anonymous"></script> -->

    <!-- 부트스트랩 5.3.left -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

    <!-- vue.js -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/vue"></script> -->

    <!-- meta og -->

    <meta property="og:title" content="web canvas 3">

    <meta property="og:description" content="web canvas 3">
    <meta name="og:image" content="http://www.mins01.com/img/logo.gif">
    <meta property="og:image:width" content="190">
    <meta property="og:image:height" content="70" />
    <meta property="og:site_name" content="web canvas 3" />
    <meta property="og:type" content="website">

    <!-- //meta og -->

    <link rel="stylesheet" href="asset/style.css">
    <style>
        canvas{
            outline: 1px dashed #aabbcc99;
        }
        #div-for-debug canvas{
            max-width: 30px;
            vertical-align: middle;
        }
        .property-wrap > .input-group{
            width: auto;
            /* min-width: 10em; */
        }
        .property-wrap > .input-group :where(.form-control, .form-select){
            min-width: 4em;
            width: auto;
        }
    </style>
    <script type="module">
        import HtmlUtil from "./wc/lib/HtmlUtil.js";
        if(!globalThis.Wc) globalThis.Wc = {}
        globalThis.Wc.HtmlUtil = HtmlUtil;
    </script>
    <script type="module">
        import Canvas from "./wc/element/Canvas.js";
        import Layer from "./wc/element/Layer.js";
        import Document from "./wc/element/Document.js";
        import TextLayer from "./wc/element/TextLayer.js";
        import RectangleLayer from "./wc/element/RectangleLayer.js";
        import EllipseLayer from "./wc/element/EllipseLayer.js";
        import Brush from "./wc/element/Brush.js";

        Canvas.defineCustomElements();
        Layer.defineCustomElements();
        Document.defineCustomElements();
        TextLayer.defineCustomElements();
        RectangleLayer.defineCustomElements();
        EllipseLayer.defineCustomElements();
        Brush.defineCustomElements();

        if(!globalThis.Wc) globalThis.Wc = {}
        globalThis.Wc.Canvas = Canvas;
        globalThis.Wc.Layer = Layer;
        globalThis.Wc.Document = Document;
        globalThis.Wc.TextLayer = TextLayer;
        globalThis.Wc.RectangleLayer = RectangleLayer;
        globalThis.Wc.EllipseLayer = EllipseLayer;

        import Editor from "./wc/Editor.js";

        window.addEventListener('load',(event)=>{
            const brush1 = globalThis.brush1 = document.querySelector('#brush1');
            brush1.contextConfig.foreColor="#f00"
            brush1.size = 10
            brush1.flush();


            const editor = globalThis.editor = new Editor(document.querySelector('#wc-editor'));
            globalThis.b1 = editor.brush = brush1
            // editor.tools.select('Brush');
            editor.addEventListener();

            editor.document.zoom = 1
            editor.document.layer.left = 30
            editor.document.layer.zoom = 1.5

            const wcl4 = globalThis.wcl4 = new Layer(100,100);
            wcl4.fill('#ff000066')
            wcl4.left = 100;
            wcl4.top = 20
            let l = editor.document.layers.item(0)
            l.fill('#00ff0066');

            // const wcl5 = globalThis.wcl5 = new TextLayer(editor.document.width,editor.document.height);
            // wcl5.text='하늘하늘! \n 그렇구나';
            // wcl5.textConfig.textColor="#0000cc"

            // editor.document.add(wcl5);

            // const wcl6 = globalThis.wcl6 = new RectangleLayer(editor.document.width,editor.document.height);
            // editor.document.add(wcl6);
            // wcl6.left=50;
            // wcl6.top=75;
            // wcl6.width=100;
            // wcl6.height=100;
            // wcl6.contextConfig.backColor="#cc0000"
            // wcl6.contextConfig.foreColor="#00cc00"
            // wcl6.contextConfig.lineWidth=5;
            // wcl6.flush();

            // const wcl7 = globalThis.wcl7 = new EllipseLayer(editor.document.width,editor.document.height);
            // editor.document.add(wcl7);
            // wcl7.left=150;
            // wcl7.top=50;
            // wcl7.width=100;
            // wcl7.height=50;
            // wcl7.contextConfig.backColor="#0000cc"
            // wcl7.contextConfig.foreColor="#cc00cc"
            // wcl7.contextConfig.lineWidth=3;
            // wcl7.flush();




            document.formBrushConfig.oninput(event)
            document.querySelector('.checkbox-tool[value="Brush"]').click();


            let divForDebug = document.querySelector('#div-for-debug');
            editor.document.add(wcl4);

            editor.document.layers.select(0);
            editor.document.ready();
            editor.document.history.save('Document.New');

            // divForDebug.append(editor.document.drawLayer)
            // editor.document.layers.all().forEach((layer,index)=>{
            //     divForDebug.append(layer)
            //     layer.onclick = (event)=>{
            //         layer.parent.select(index);
            //     }
            // })
        })
    </script>

    <script>
        function randomFill(event){
            const target = event.target;
            if(target.nodeName == 'CANVAS'){
                let c = '#'+(Math.random() * 0xFFFFFF << 0).toString(16).padStart(6, '0');

                target.fill(c)
            }
        }
    </script>
    <style>
        .wc-document{
            /* position: absolute; */
        }
    </style>

    <script>
        globalThis.addEventListener('load',(event)=>{
            const wcApp = globalThis.wcApp = document.querySelector('#wc-app')
        })
    </script>
</head>
<body>
    <div id="wc-app" class="wc-app debug-box">
        <div class="wc-app-wrap">
            <div class="wc-app-header">
                <div class="wc-app-nav d-flex gap-1 px-2 py-1 justify-content-center mx-auto" style="">
                    <button type="button" class="btn btn-lg btn-outline-light p-1" style="width:2em;height:2em;"  data-bs-toggle="modal" data-bs-target="#modal-menu-main"><i class="bi bi-menu-app"></i></button>
                    <button type="button" class="btn btn-lg btn-outline-light p-1" style="width:2em;height:2em;" onclick="this.classList.toggle('active'); wcApp.classList.toggle('show-wc-app-tools')"><i class="bi bi-brush"></i></button>
                    <button type="button" class="btn btn-lg btn-outline-light p-1" style="width:2em;height:2em;"><i class="bi bi-collection"></i></button>
                    <button type="button" class="btn btn-lg btn-outline-light p-1" style="width:2em;height:2em;" data-bs-toggle="modal" data-bs-target="#modal-layers"><i class="bi bi-layers"></i></button>
                    <button type="button" class="btn btn-lg btn-outline-light p-1" style="width:2em;height:2em;"><i class="bi bi-palette"></i></button>
                    <button type="button" class="btn btn-lg btn-outline-light p-1" style="width:2em;height:2em;">X</button>
                </div>
                <div class="wc-app-tools gap-1 px-2 py-1 d-flex flex-wrap justify-content-center mx-auto " >
                    <label role="button" title="tool Line" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  value="Line" onclick="editor.tools.select('Line')" checked><button type="button" class="btn btn-md btn-outline-success pe-none" ><i class="bi bi-slash-lg"></i></button></label>
                    <label role="button" title="tool Pen" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  value="Pen" onclick="editor.tools.select('Pen')"><button type="button" class="btn btn-md btn-outline-success pe-none"><i class="bi bi-pen"></i></button></label>
                    <label role="button" title="tool Brush" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  value="Brush" onclick="editor.tools.select('Brush')"><button type="button" class="btn btn-md btn-outline-success pe-none"><i class="bi bi-brush"></i></button></label>
                    <label role="button" title="tool Eraser" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  value="Eraser" onclick="editor.tools.select('Eraser')"><button type="button" class="btn btn-md btn-outline-success pe-none"><i class="bi bi-eraser"></i></button></label>       
                    <label role="button" title="tool Move" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  value="Move" onclick="editor.tools.select('Move')"><button type="button" class="btn btn-md btn-outline-success pe-none"><i class="bi bi-arrows-move"></i></button></label>
                    <label role="button" title="tool Hand" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  value="Move" onclick="editor.tools.select('Hand')"><button type="button" class="btn btn-md btn-outline-success pe-none"><i class="bi bi-hand-index"></i></button></label>
                    <label role="button" title="tool Rectangle" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  value="Rectangle" onclick="editor.tools.select('Rectangle')"><button type="button" class="btn btn-md btn-outline-success pe-none"><i class="bi bi-square"></i></button></label>
                    <label role="button" title="tool Circle" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  value="Circle" onclick="editor.tools.select('Circle')"><button type="button" class="btn btn-md btn-outline-success pe-none"><i class="bi bi-circle"></i></button></label>
                    <label role="button" title="tool Text" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  value="Text" onclick="editor.tools.select('Text')"><button type="button" class="btn btn-md btn-outline-success pe-none"><i class="bi bi-body-text"></i></button></label>
                    <label role="button" title="tool Text commit" ><input hidden class="btn-check position-absolute checkbox-tool" type="radio" name="tool"  onclick="editor.tool.commit()"><button type="button" class="btn btn-md btn-outline-success pe-none" ><i class="bi bi-body-text"></i><i class="bi bi-bandaid"></i></button></label>
                </div>
    
            </div>
    
            <div class="wc-app-footer">
    
            </div>
            <div id="wc-editor" class="wc-editor wc-app-body debug-box">
                <div class="wc-frame">
                    <canvas id="wc-document" class="wc-document" width="300" height="300" is="wc-document"></canvas>
                </div>
            </div>
            <div class="wc-app-etcs">
                <div class="d-flex gap-1 p-1">
                    <button type="button" class="btn btn-sm btn-primary" onclick="editor?.document.history.undo()">UNDO</button>
                    <button type="button" class="btn btn-sm btn-primary" onclick="editor?.document.history.redo()">REDO</button>
                    <button type="button" class="btn btn-sm btn-primary" onclick="editor?.document.history.save('manual')">SAVE</button>
                </div>
            </div>
            <div class="wc-app-modal-btns">
                <div class="d-flex gap-1 flex-wrap">
                    <!-- <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#modal-menu-main">Main</button> -->
                    <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#modalProperty">Property</button>
                    <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#modalText">Text</button>
                    <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#modalBrush">Brush</button>
                    <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#modal-layer">Layer</button>
                    <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#modalDocument">Document</button>
                </div>
            </div>
        </div>
        <!-- <div class="wc-app-preview-layers">
            <div id="div-for-debug" class="preview-layers">

            </div>
            <div>
                <button type="button" class="btn btn-primary" onclick="if(editor?.document?.layer){ editor.document.layer.visible = true; editor.document.layer.flush() }">visible:on</button>
                <button type="button" class="btn btn-primary" onclick="if(editor?.document?.layer){ editor.document.layer.visible = false; editor.document.layer.flush() }">visible:off</button>
            </div>
        </div> -->
    </div>

    <!-- Modal -->
    <div class="modals">

        <div class="modal fade" id="modal-menu-main"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4">Webapp WC3</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row g-1">
                            <div class="col-6">
                                <button type="button" class="w-100 btn btn-lg btn-primary" data-bs-toggle="modal" data-bs-target="#modal-file-new"><i class="bi bi-file-earmark-plus"></i> NEW</button>
                            </div>
                            <div class="col-6">
                                <button type="button" class="w-100 btn btn-lg btn-primary" data-bs-toggle="modal" data-bs-target="#modal-file-load"><i class="bi bi-file-earmark-arrow-up"></i> LOAD</button>
                            </div>
                            <div class="col-6">
                                <button type="button" class="w-100 btn btn-lg btn-primary" data-bs-toggle="modal" data-bs-target="#modal-file-save"><i class="bi bi-file-earmark-arrow-down"></i> SAVE</button>
                            </div>
                            <div class="col-6">
                                <button type="button" class="w-100 btn btn-lg btn-primary" onclick="editor.closeDocument()"><i class="bi bi-x-circle"></i> CLOSE</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="modal-file-load"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4"><i class="bi bi-file-earmark-arrow-up"></i> LOAD</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form action="" onsubmit="if(this.loadfile.files.length){ editor.loadDocument(this.loadfile.files[0]); this.reset() }else{ alert('Select a file(*.wc3.json)')}; return false;" >
                            <div class="input-group input-group-lg">
                                <input type="file" class="form-control" name="loadfile" accept=".wc3.json">
                                <button type="submit" class="btn btn-primary" ><i class="bi bi-file-earmark-arrow-up"></i> LOAD</button>
                            </div>
                            <div class="form-text text-end"><i class="bi bi-info-circle"></i> *.wc3.json만 지원됩니다.</div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="modal-file-save"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4"><i class="bi bi-file-earmark-arrow-down"></i> SAVE</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="d-flex flex-column gap-1 p-1">
                            <div>
                                <button type="button" class="w-100 btn btn-lg btn-primary" onclick="editor.saveDocument('wc.json')"><i class="bi bi-filetype-json"></i> SAVE wc3.json</button>
                                <div class="form-text text-end mt-0 mb-2"><i class="bi bi-info-circle"></i> 레이어 정보가 같이 저장됩니다.</div>
                            </div>
                            <div>
                                <button type="button" class="w-100 btn btn-lg btn-primary" onclick="editor.saveDocument('png')"><i class="bi bi-filetype-png"></i> SAVE png</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="modal-file-new"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4"><i class="bi bi-file-earmark-plus"></i> NEW</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form action="" onsubmit="editor.newDocument(this.width.value,this.height.value); return false;">
                            <div class="d-flex flex-column gap-1">
                                <div>
                                    <label for="" class="form-label">Size</label>
                                    <div class="input-group input-group-lg">
                                        <input type="number" class="form-control" name="width" placeholder="width" min="1" max="10000" value="300">
                                        <span class="input-group-text" >x</span>
                                        <input type="number" class="form-control" name="height" placeholder="height" min="1" max="10000" value="300">
                                    </div>
                                </div>
                                <div>
                                    <button class="w-100 btn btn-lg btn-primary">Create</button>
                                </div>
                            </div> 
                        </form>
                    </div>
                </div>
            </div>
        </div>


        <div class="modal fade" id="modalText"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4">text</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form action="" onsubmit="return false;" oninput="if(editor.document.layer){editor.document.layer.flush()}">
                            <h3 class="fs-5">TEXT</h3>
                            <textarea name="" rows="3" class="form-control" id="" oninput="if(editor.document.layer.setText !==undefined){editor.document.layer.setText(this.value);}" onfocus="if(editor.document.layer.text){ this.value=editor.document.layer.text}"></textarea>
                        </form>
                        <hr>
                        <form action="" onsubmit="return false;" oninput="editor.setTextConfig(Wc.HtmlUtil.formToObject(this)); return false" onchange="this.oninput(event); return false">
                            <div class="d-flex flex-wrap gap-1 property-wrap">
                                <div class="input-group">
                                    <span class="input-group-text" >글자색</span>
                                    <input type="color" class="form-control form-control-color"  name="textColor" value="#00ff00">
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >글자크기</span>
                                    <label class="form-control" role="button">
                                        <input type="range" class="form-range d-block" name="fontSizeNumber" value="10" step="1" min="0" max="100">
                                    </label>
                                    <select name="fontSizeUnit" class="form-select" >
                                        <option value="px">px</option>
                                        <!-- <option value="pt">pt</option> -->
                                    </select>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >lineHeight</span>
                                    <label class="form-control" role="button">
                                        <input type="range" class="form-range d-block" name="lineHeightNumber" value="1.5" step="0.1" min="0" max="100">
                                    </label>
                                    <select name="lineHeightUnit" class="form-select" >
                                        <option value="em">em</option>
                                        <option value="px">px</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >fontWeight</span>
                                    <select name="fontWeight" class="form-select" >
                                        <option value="normal">normal</option>
                                        <option value="bold">bold</option>
                                        <option value="bolder">bolder</option>
                                        <option value="lighter">lighter</option>
                                        <option value="100">100</option>
                                        <option value="200">200</option>
                                        <option value="300">300</option>
                                        <option value="400">400</option>
                                        <option value="500">500</option>
                                        <option value="600">600</option>
                                        <option value="700">700</option>
                                        <option value="800">800</option>
                                        <option value="900">900</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >fontStyle</span>
                                    <select name="fontStyle" class="form-select" style="width: 6em;">
                                        <option value="normal">normal</option>
                                        <option value="italic">italic</option>
                                        <option value="oblique">oblique</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >fontFamily</span>
                                    <select name="fontFamily" class="form-select" style="width: 6em;">
                                        <option value="">Default</option>
                                        <option value="sans-serif">sans-serif</option>
                                        <option value="serif">serif</option>
                                        <option value="monospace">monospace</option>
                                        <option value="Arial, sans-serif">Arial</option>
                                        <option value="Helvetica, sans-serif">Helvetica</option>
                                        <option value="cursive">cursive</option>
                                        <option value="fantasy">fantasy</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >textPadding</span>
                                    <label class="form-control" role="button">
                                        <input type="range" class="form-range d-block" name="textPaddingNumber" value="0" step="0.1" min="0" max="100">
                                    </label>
                                    <select name="textPaddingUnit" class="form-select" >
                                        <option value="px">px</option>
                                        <option value="em">em</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >letterSpacing</span>
                                    <label class="form-control" role="button">
                                        <input type="range" class="form-range d-block" name="letterSpacingNumber" value="0" step="0.1" min="-10" max="10">
                                    </label>
                                    <select name="letterSpacingUnit" class="form-select" >
                                        <option value="px">px</option>
                                        <option value="em">em</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >textAlign</span>
                                    <select name="textAlign" class="form-select" style="width: 6em;">
                                        <option value="left">left</option>
                                        <option value="right">right</option>
                                        <option value="center">center</option>
                                        <option value="start">start</option>
                                        <option value="end">end</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >textBaseline</span>
                                    <select name="textBaseline" class="form-select" style="width: 6em;">
                                        <option value="alphabetic">alphabetic(이걸로 고정하자)</option>
                                        <option value="top">top</option>
                                        <option value="middle">middle</option>
                                        <option value="bottom">bottom</option>
                                        <option value="hanging">hanging</option>
                                        <option value="ideographic">ideographic</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="modalProperty"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4">property</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form action="" onsubmit="return false;" oninput="editor.setContextConfig(Wc.HtmlUtil.formToObject(this)); return false" onchange="this.oninput(event); return false">
                            <h3 class="fs-5">COLOR</h3>
                            <div class="d-flex flex-wrap gap-1 property-wrap">
                                <div class="input-group">
                                    <span class="input-group-text" >전경색</span>
                                    <input type="color" class="form-control form-control-color"  name="foreColor" value="#ff0000">
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >배경색</span>
                                    <input type="color" class="form-control form-control-color"  name="backColor" value="#00ff00">
                                </div>
                            </div>
                            <hr class="my-1">
                            <h3 class="fs-5">LINE AND FILL</h3>
                            <div class="d-flex flex-wrap gap-1 property-wrap">
                                <div class="input-group">
                                    <span class="input-group-text" >선크기</span>
                                    <label class="form-control" role="button">
                                        <input type="range" class="form-range d-block" name="lineWidth" value="3" min="0" max="180" step="1">
                                    </label>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >질하기순서</span>
                                    <label class="form-control" role="button"><input type="radio" value="true" name="fillAfterStroke" checked> fill-stroke</label>
                                    <label class="form-control" role="button"><input type="radio" value="false" name="fillAfterStroke"> stroke-fill</label>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >칠하기</span>
                                    <label class="form-control" role="button"><input type="radio" value="false" name="disableFill" checked> 사용</label>
                                    <label class="form-control" role="button"><input type="radio" value="true" name="disableFill"> 금지</label>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >테두리</span>
                                    <label class="form-control" role="button"><input type="radio" value="false" name="disableStroke" checked> 사용</label>
                                    <label class="form-control" role="button"><input type="radio" value="true" name="disableStroke"> 금지</label>
                                </div>

                                <!-- 우선 inside 로 고정
                                <div class="input-group">
                                    <span class="input-group-text" >strokeLocation</span>
                                    <select name="strokeLocation" class="form-select">
                                        <option value="inside">inside</option>
                                        <option value="center">center</option>
                                        <option value="outside">outside</option>
                                    </select>
                                </div> -->
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="modalBrush"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4">brush</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form name="formBrushConfig" action="" oninput="b1.setBrushConfig(Wc.HtmlUtil.formToObject(this));b1.flush();  return false" >
                            <div class="text-center d-flex justify-content-center align-items-center" style="min-height: 100px;">
                                <canvas id="brush1" is="wc-brush" width="5" height="5"></canvas>
                            </div>
                            <hr>
                            <div class="d-flex flex-wrap gap-1 property-wrap">
                                <div class="input-group">
                                    <span class="input-group-text" >size</span>
                                    <input class="form-control" type="number" name="size" placeholder="size"
                                        onfocus="if(b1){ this.value = b1.brushConfig[this.name];}"
                                        value="5"
                                        >
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >roundness(원형율)</span>
                                    <input class="form-control" type="number" name="roundness" placeholder="roundness" step="0.05" min="0" max="1"
                                        onfocus="if(b1){ this.value = b1.brushConfig[this.name];}"
                                        value="1"
                                        >
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >angle(각도)</span>
                                    <input class="form-control" type="number" name="angle" placeholder="angle" step="0.05" min="-1" max="1"
                                        onfocus="if(b1){ this.value = b1.brushConfig[this.name];}"
                                        value="0"
                                        >
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >hardness(경도)</span>
                                    <input class="form-control" type="number" name="hardness" placeholder="hardness" step="0.05" min="0" max="1"
                                        onfocus="if(b1){ this.value = b1.brushConfig[this.name];}"
                                        value="1"
                                        >
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >opacity(불투명도)</span>
                                    <input class="form-control" type="number" name="opacity" placeholder="opacity" step="0.05" min="0" max="1"
                                        onfocus="if(b1){ this.value = b1.brushConfig[this.name];}"
                                        value="1"
                                        >
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >spacing(간격)</span>
                                    <input class="form-control" type="number" name="spacing" placeholder="spacing" step="0.005" min="0.005" max="2"
                                        onfocus="if(b1){ this.value = b1.brushConfig[this.name];}"
                                        value="0.25"
                                        >
                                </div>
                                <div class="input-group">
                                    <span class="input-group-text" >solidColor(단색)</span>
                                    <select class="form-select " name="solidColor" id="" onfocus="if(b1){ this.value = b1.brushConfig[this.name];}"  >
                                        <option selected value="">NO</option>
                                        <option value="1">YES</option>

                                    </select>
                                </div>

                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>



        <div class="modal fade" id="modalDocument"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4">document</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="d-flex flex-wrap gap-1">
                            <form action="" onsubmit="if(editor?.document) { editor.document.zoom=parseFloat(this.zoom.value); editor.document.flush();} return false" oninput="return this.onsubmit(event)">
                                <div class="input-group" style="width:300px;">
                                    <span class="input-group-text">ZOOM</span>
                                    <input class="form-control" type="number" name="zoom" placeholder="zoom"
                                        step="0.05" min="0" max="3"
                                        onfocus="if(editor?.document){ this.form.zoom.value = editor?.document.zoom;}"
                                        >
                                    <button class="btn btn-primary">변경</button>
                                </div>
                            </form>
                            <form action="" onsubmit="if(editor?.document) { editor.document.angle=parseFloat(this.angle.value); editor.document.flush();} return false" oninput="return this.onsubmit(event)">
                                <div class="input-group" style="width:300px;">
                                    <span class="input-group-text">ANGLE</span>
                                    <input class="form-control" type="number" name="angle" placeholder="angle"
                                        step="0.05" min="-1" max="1"
                                        onfocus="if(editor?.document){ this.form.angle.value = editor?.document.angle;}"
                                        >
                                    <button class="btn btn-primary">변경</button>
                                </div>
                            </form>

                        </div>
                        <hr>
                        <form action="" onsubmit="return false;" oninput="if(editor.document.layer){editor.document.layer.flush()}">
                            <h3 class="fs-5">TEXT</h3>
                            <textarea name="" rows="3" class="form-control" id="" oninput="if(editor.document.layer.setText !==undefined){editor.document.layer.setText(this.value);}" onfocus="if(editor.document.layer.text){ this.value=editor.document.layer.text}"></textarea>
                        </form>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>


        <div class="modal fade" id="modal-layers"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4"><i class="bi bi-layers"></i> Layers</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="my-1 d-flex justify-content-end gap-1">
                            <div class="d-flex justify-content-start gap-1">
                                <button type="button" class="btn btn-primary" onclick="editor?.document?.layers.addLayer();editor?.document?.layer.flush();"><i class="bi bi-plus-circle"></i></button>
                                <button type="button" class="btn btn-primary" onclick="editor?.document?.layer.clear();editor?.document?.layer.flush();editor?.document?.history.save('layer.clear')"><i class="bi bi-eraser-fill"></i></button>
                                <button type="button" class="btn btn-primary" onclick="editor?.document?.layers.remove();editor?.document?.layer.flush()"><i class="bi bi-trash"></i></button>

                            </div>
                            <div class="d-flex justify-content-end gap-1 flex-fill">
                                <input type="range" id="layer-alpha" min="0" max="1" value="1" step="0.01" oninput="if(editor?.document?.layer){ editor.document.layer.alpha = this.value; editor.document.layer.flush(); editor.document.layers.ready()}" >
                                <button type="button" class="btn btn-primary" onclick="editor?.document.layers.moveUp()"><i class="bi bi-layer-forward"></i></button>
                                <button type="button" class="btn btn-primary" onclick="editor?.document.layers.moveDown()"><i class="bi bi-layer-backward"></i></button>
                            </div>
                        </div>
                        <hr class="my-1">
                        <template id="template-layer-box" >
                            <div class="layer-box d-flex gap-1 align-items-center p-1" role="button">
                                <button class="btn layer-box-eye d-flex justify-content-center align-items-center p-0 m-0 px-2">
                                    <i class="bi bi-eye on-visible"></i>
                                    <i class="bi bi-eye-slash no-visible"></i>
                                </button>
                                <button class="btn layer-box-content text-start flex-fill d-flex gap-1 align-items-center p-0 m-0">
                                    <div class="layer-box-preview">canvas</div>
                                    <div class="layer-box-detail">
                                        <div>
                                            <div class="layer-box-detail-label"></div>
                                        </div>
                                        <small class="d-flex flex-wrap gap-3 row-gap-1">
                                            <div class="d-flex gap-1">
                                                <div>Size</div>
                                                <div class="layer-box-detail-size"></div>
                                            </div>
                                            <div class="d-flex gap-1">
                                                <div><i class="bi bi-zoom-in"></i></div>
                                                <div class="layer-box-detail-zoom"></div>
                                            </div>
                                            <div class="d-flex gap-1">
                                                <div><i class="bi bi-at"></i></div>
                                                <div class="layer-box-detail-alpha"></div>
                                            </div>
                                        </small>
                                    </div>
                                </button>
                                <button class="btn layer-box-config d-flex justify-content-center align-items-center p-0 m-0 px-2" data-bs-toggle="modal" data-bs-target="#modal-layer">
                                    <i class="bi bi-sliders"></i>
                                </button>
                            </div>
                        </template>
                        <div class="layer-box-container d-flex flex-column gap-1">
                            
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="modal-layer"  aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-4"><i class="bi bi-layers-half"></i> Layer</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="d-flex flex-wrap gap-1">

                            <form name="form_layer_resize" class="flex-fill" action="" onsubmit="if(editor?.document?.layer){ editor.document.layer.resize(this.width.value,this.height.value);editor.document.layer.flush();editor.document.layers.ready(); editor.document.history.save(); } return false">
                                <div class="input-group w-100">
                                    <span class="input-group-text justify-content-center" style="width:6em" >Size</span>
                                    <input class="form-control" type="number" name="width" placeholder="width" min="1" max="10000">
                                    <span class="input-group-text" >X</span>
                                    <input class="form-control" type="number" name="height" placeholder="height" min="1" max="10000">
                                    <button type="submit"  style="width:6em" class="btn btn-primary">Resize</button>
                                </div>
                            </form>
                            <form name="form_layer_zoom" class="flex-fill" action="" onsubmit="if(editor?.document?.layer) { editor.document.layer.zoom=parseFloat(this.zoom.value); editor.document.layer.flush();editor.document.layers.ready(); editor.document.history.save(); } return false" oninput="return this.onsubmit(event)"  oninput="return this.onsubmit(event)">
                                <div class="input-group w-100">
                                    <span class="input-group-text justify-content-center" style="width:6em" >Zoom</span>
                                    <input class="form-control" type="number" name="zoom" placeholder="zoom" step="0.05" min="0" max="5" >
                                    <button type="submit"  style="width:6em" class="btn btn-primary">Change</button>
                                </div>
                            </form>
                            <form name="form_layer_angle" class="flex-fill" action="" onsubmit="if(editor?.document?.layer) { editor.document.layer.angle=parseFloat(this.angle.value); editor.document.layer.flush();editor.document.layers.ready(); editor.document.history.save(); } return false" oninput="return this.onsubmit(event)">
                                <div class="input-group w-100">
                                    <span class="input-group-text justify-content-center" style="width:6em" >Angle</span>
                                    <input class="form-control" type="number" name="angle" placeholder="angle" step="0.05" min="-1" max="1">
                                    <button type="submit"  style="width:6em" class="btn btn-primary">Change</button>
                                </div>
                            </form>

                            <form name="form_layer_postion" class="flex-fill" action="" onsubmit="if(editor?.document?.layer){ editor.document.layer.postion(this.left.value,this.top.value); editor.document.layer.flush(); editor.document.layers.ready(); editor.document.history.save();  } return false " oninput="return this.onsubmit(event)" >
                                <div class="input-group w-100">
                                    <span class="input-group-text justify-content-center" style="width:4em" >Left</span>
                                    <input class="form-control" type="number" name="left" placeholder="left" min="-10000" max="10000">
                                    <span class="input-group-text justify-content-center" style="width:4em" >Top</span>
                                    <input class="form-control" type="number" name="top" placeholder="top" min="-10000" max="10000">
                                    <button type="submit"  style="width:6em" class="btn btn-primary">Postion</button>
                                </div>
                            </form>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <script>
            window.addEventListener('load',(event)=>{
                // window.modalLayer = new bootstrap.Modal('#modal-layer')
                document.querySelector('#modal-layer').addEventListener('show.bs.modal', event => {
                    const layer = editor?.document?.layer
                    console.log(layer);
                    if(!layer){return;}
                    {
                        const f = document.form_layer_resize;
                        
                        f.width.value = layer.width
                        f.height.value = layer.height
                        f.width.value = layer.width
                        f.height.value = layer.height
                    }
                    {
                        const f = document.form_layer_zoom;
                        f.zoom.value = layer.zoom
                    }
                    {
                        const f = document.form_layer_angle;
                        f.angle.value = layer.angle
                    }
                    {
                        const f = document.form_layer_postion;
                        f.left.value = layer.left
                        f.top.value = layer.top
                    }
                    
                    
                })
            })
        </script>
    </div>
    
</body>
</html>